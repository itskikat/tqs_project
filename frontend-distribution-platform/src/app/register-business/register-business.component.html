<nb-layout center>
    <nb-layout-header>
        <span class="navbar-text" style="text-align: center;width:100%;">
            Business Registration
        </span>
    </nb-layout-header>

    <nb-layout-column>
        <nb-card class="col-md-12 col-lg-12 col-xxxl-12">
            <nb-card-body>
                <nb-stepper orientation="horizontal">
                    <nb-step [label]="labelTwo" [stepControl]="businessAccountForm">
                        <ng-template #labelTwo>Account</ng-template>
                        <h3>Register Account</h3>
                        <form [formGroup]="businessAccountForm">
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input nbInput style="max-width: 100%;" placeholder="Enter account email"
                                    class="form-control" type="email" required formControlName="email">
                            </div>
                            <div class="form-group">
                                <label>Password</label>
                                <input nbInput style="max-width: 100%;" placeholder="Password"
                                    class="form-control" type="password" required formControlName="pass">
                            </div>
                            <div class="form-group">
                                <label>Password</label>
                                <input nbInput style="max-width: 100%;" placeholder="Confirm password"
                                    class="form-control" type="password" required formControlName="newpass">
                            </div>
                        </form>
                        <div class="row">
                            <button nbButton nbStepperNext class="mr-auto ml-auto">next</button>
                        </div>
                    </nb-step>
                    <nb-step [label]="labelOne" [stepControl]="businessDataForm">
                        <ng-template #labelOne>Business data</ng-template>
                        <h3>Business data</h3>
                        <form [formGroup]="businessDataForm">

                            <div class="form-group">
                                <label for="fistName">Company name</label>
                                <input nbInput style="max-width: 100%;" placeholder="Enter the company"
                                    class="form-control" required formControlName="companyName">
                            </div>
                            <div class="form-group">
                                <label>VAT Number</label>
                                <input nbInput style="max-width: 100%;" placeholder="Enter your VAT"
                                    class="form-control" required formControlName="vat">
                            </div>
                            <div class="form-group">
                                <label>Address</label>
                                <input nbInput style="max-width: 100%;" placeholder="Enter your fiscal address"
                                    class="form-control" required formControlName="address">
                            </div>
                            
                        </form>
                        <div class="row">
                            <button nbButton nbStepperPrevious class="ml-auto mr-3">previous</button>
                            <button nbButton nbStepperNext class="mr-auto ml-3" (click)="saveBusiness()">regist</button>
                        </div>

                    </nb-step>
                    <nb-step [label]="labelTwo" class="">
                        <ng-template #labelTwo>API Token</ng-template>

                        <div class="d-flex flex-column" *ngIf="!tokenGenerated">
                            <h3>Almost there...</h3>
                            <p>The last step to integrate your business with our service it to generate an API Token.</p>
                            <p>This token is going to be used by your app in order itself to the API.</p>
                            
                            <nb-alert status="warning">
                                Attention! You will only be able to see the token once. Ensure that you store it safely
                            </nb-alert>
    
                            <button 
                                nbButton 
                                (click)="generateToken()"
                                class="mx-auto mb-3"
                            >Generate token</button>

                            <div class="row">
                                <button nbButton nbStepperPrevious class="mx-auto">previous</button>
                            </div>
                        </div>

                        <div *ngIf="tokenGenerated">
                            <p>Your token has been generated successfully and is shown below!</p>
                            <nb-alert outline="success" class="my-5 text-center">
                                {{token}}
                            </nb-alert>
                            <p>You must use it every time your app calls the API. See how in the <a>documentation</a>.</p>
                            <p>You can now access the dashboard and monitor your app stats. To do so press FINISH.</p>
                            
                            <div class="row">
                                <button nbButton (click)="finishRegister()" class="mr-auto ml-3">finnish</button>
                            </div>
                        </div>

                    </nb-step>

                </nb-stepper>
            </nb-card-body>
        </nb-card>
    </nb-layout-column>
    <nb-layout-footer>
        <a routerLink="/login" >
            <button nbButton>Go back to login page</button>
        </a>
    </nb-layout-footer>
</nb-layout>